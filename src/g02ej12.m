% Ejercicio 5
A = [16.87  0.1650  0.2019  0.3170  0.2340  0.1820  0.1100;
     0.0    27.70   0.8620  0.0620  0.0730  0.1310  0.1200;
     0.0    0.0     22.35   13.05   4.420   6.001   3.043;
     0.0    0.0     0.0     11.28   0.0     1.110   0.3710;
     0.0    0.0     0.0     0.0     9.850   1.1684  2.108;
     0.0    0.0     0.0     0.0     0.2990  15.98   2.107;
     0.0    0.0     0.0     0.0     0.0     0.0     4.670];

h = [17.1 65.1 186.0 82.7 84.2 63.7 119.7]';

[L,U,r] = doolittle_p(A,h);
x = doolittle_sol(L,U,h);
R_abs = abs(38.78-sum(x));
R_rel = R_abs/38.78;


% Ejercicio 6
R = [80,  -50,  -30,  0;
     -50, 100,  -10,  -25;
     -30, -10,  65,   -20;
     0,   -25,  -20,  100];

v = [120 0 0 0]';

[L,U,r] = doolittle_p(R,v);
i = doolittle_sol(L,U,v);


% Ejercicio 7
n=100;
M=zeros(n);
b=zeros(n,1) + 1/n^2;

M(1,1)=1;
M(n,n)=1;

b(1)=0;
b(n)=0;

for i=2:n-1
   M(i,i)=2;
   M(i,i-1)=-1;
   M(i,i+1)=-1;
endfor

[L,U,r] = doolittle_p(M,b);
x = doolittle_sol(L,U,b);

t=[0:1/99:1];

plot(t,x');
